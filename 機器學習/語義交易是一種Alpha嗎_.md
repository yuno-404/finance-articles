---
title: 語義交易是一種Alpha嗎?

---

## Prediction Market
前面有提到過 Polymarket，這裡有一篇關於AI代理預測市場的熱騰騰論文
這篇論文
* 驗證了在預測市場中，語義結構（Semantic Structure）本身就是一種可交易的 Alpha（超額報酬來源）
* 再來是用 NLP（自然語言處理）取代統計學來找資產關聯
* 將 MCP 作為標準化接口，讓 AI 能自動化地完成「讀取 -> 分群 -> 找關係 -> 交易」的一條龍流程 
* 主要發現： 使用 Polymarket 的歷史數據評估，該 AI 識別的關係準確率約為 60-70%，基於此關係的簡單交易策略在為期一週的範圍內平均回報率約為 20% 。

所以真的能用 Agent 去操盤 polymarket 嗎?
這是怎麼做到的?

----
### Methodology (方法論)
#### 第一階段：構建 AI 工具箱 (MCP Tools) 
MCP 工具 (Model Context Protocol)： 讓 AI 代理人可以接收標準化輸入並產出標準化輸出（CSV 或 JSON） 

#### Clustering MCP： 使用向量空間模型將市場分組為主題集群（Cluster） 。
* 向量空間模型 (Vector-space model)： 系統會讀取每個市場的文字（問題描述），將其轉換為向量（Embedding），投射到一個共享的隱含空間中 。
* 幾何鄰近性： 在向量空間中距離相近的市場，代表語義相似，會被歸類在一起 。

分群數量 ($K$) 的設定：
* 公式：$K \approx \lfloor N/10 \rfloor$（其中 $N$ 是該批次的市場總數）。
* 目的： 確保每個群組夠小，方便後續精確尋找兩兩關係；同時又夠大，能包含不同的改寫語句或相關命題 。
    * 輸出結果： 每個市場的群組分配結果，以及每個群組的清單（CSV 格式）。
```
class Cluster(BaseModel):
    markets: str
    category: str
```


1. #### Cluster Labeling MCP： 使用 LLM 為每個集群分配類別標籤（如政治、加密貨幣、科技等） 。
* 輸入： 包含一連串市場問題文本的群組物件 。
* 處理： 使用大型語言模型（LLM），限制其輸出必須符合預設的分類法 。
* 分類法 (Taxonomy)： 使用輕量級的封閉分類，例如：「政治 (politics)」、「宏觀經濟 (macro)」、「金融 (finance)」、「財報 (earnings)」、「加密貨幣 (crypto)」、「科技 (tech)」、「體育 (sports)」、「文化 (culture)」、「其他 (other)」。
目的： 確保不同批次的執行結果一致，並支援後續針對不同領域進行評估 。

#### Relationship Discovery MCP： 在集群內部尋找「相同結果」或「不同結果」的市場對，並提供信心分數與理由 。
**這是核心步驟!要找出哪兩個市場的結果是連動的**
* 輸入： 一個群組的市場列表（可選擇性加入新聞摘要）。
* 處理： 執行非同步的生成任務，產出候選的市場對（Pairs）。
* AI 的指令 (Prompt) 邏輯： 採用「提議並結構化 (propose-and-structure)」的方式，要求 LLM 僅提出「非常可能相關」的配對，並明確承諾方向（相同或不同）與信心分數 。


輸出資料結構 (MarketRelation)：對於每一對市場 $(i, j)$，AI 需輸出：
1. 問題文本： 直接複製原始問題 。
2. 結果是否相同 (is_same_outcome)： 布林值。True 代表兩者結果會一樣（都 Yes 或都 No）；False 代表結果相反 。
3. 信心分數 (confidence_score)： 0 到 1 之間的浮點數 。
4. 理由 (rationale)： 簡短解釋為什麼這兩者相關 。

到這裡才完成了第一屆段內容
![image](https://hackmd.io/_uploads/B1DO4LDHZx.png)

#### 第二階段:執行代理工作流程
將上述工具串聯起來，形成自動化流程：
* 分群： 將所有預測市場輸入，分組成不同 Clusters 。
* 標註： 對每個 Cluster 進行分類標註，並可選地獲取額外背景資訊（如新聞搜尋）。
* 轉換 (Transduction)： 將每個 Cluster（由 SingleMarket 物件組成的列表）轉換為關係列表（MarketRelationList 物件）。
    * 轉換公式：$(AG[SingleMarket_1], ..., AG[SingleMarket_N]) \ll AG[MarketRelationList]$
    * 左邊是 輸入 (Input)。
        * 代表一個「群組（Cluster）」內的所有預測市場資料。
        * $N$ 是這個群組內的市場數量。每一個 SingleMarket 都包含該市場的問題文字、開始與結束時間 。
        * 想像成：把 20 個關於「川普關稅」的市場資料打包在一起
    * 符號 $\ll$ (Transduction Operator)
        * 它的意思是：「使用大型語言模型（LLM），依據右邊規定的格式，將左邊的資料進行轉換」。
    * 右邊 $AG[MarketRelationList]$：
        * 這是 輸出 (Output)。
        * 代表轉換後的目標格式。
        * AI 必須吐出一個 MarketRelationList 物件，裡面包含了一張清單，列出哪兩個市場有關聯、是正相關還是負相關、以及信心分數是多少 。

#### 第三階段：資料準備與篩選 (Data Sets)
資料來源是 Polymarket 上 2025 年 4 月至 7 月間已解決（Resolved）且交易量最大的市場，透過 Dune Analytics 抓取 。
* 僅限二元結果 (Binary outcomes only)：
    * 只選 YES/NO 市場 。
    * 原因： 這樣「相同」或「不同」的定義才明確。多重結果（Multi-outcome）市場可能有互斥性或順序性問題（例如選舉勝分級距），會讓模型變複雜 。
* 市場存續時間 > 1 週 (Markets longer than one week)：
    * 排除交易窗口（開始到結束）短於 7 天的市場 。
    * 原因： 短期市場（如每小時比特幣價格、體育賽事）通常依賴即時事件而非語義邏輯，且回測時極度敏感於時間延遲，容易產生誤差 。
* 基於月份的文本篩選 (Month-based splitting)：
    * 透過過濾問題文本中明確提到的月份（例如 "in April"）來建立樣本 。
    * 原因： 這能提供一個簡單、不依賴平台元數據（Metadata）的時間劃分方式，避免重複計算那些不斷重新上架的相同命題 。

#### 第四階段：評估與驗證 (Evaluation)
如何證明 AI 找出的關係是正確且有用的？作者設計了兩個評估維度：
#### 準確度評估 (Cluster Accuracy)
* 定義真實結果 (Ground Truth)
    * 如果市場 $i$ 和市場 $j$ 的最終結果（Outcome）一樣，則為 1，否則為 0 。
    * 公式：$ground\_truth(i, j) := 1\{outcome_i = outcome_j\}$ 
* 定義預測正確 (Is Correct)
    * 如果 AI 預測的 is_same_outcome 與真實結果一致，則為正確 。
* 篩選條件： 只評估信心分數 $\ge 0.5$ 的高信心連結 。

#### 交易策略回測 (Trading Strategy)
* 策略邏輯：領導者-追隨者 (Leader-Follower)
    * 這是一個單腳（Single-leg）策略。
    * 針對一對相關市場 $(i, j)$，等待較早結束的市場 $i$（領導者）解決 (Resolved) 。
    * 一旦 $i$ 解決，立刻在市場 $j$（追隨者）的第一個價格跳動點進場交易 。
* 買賣方向判斷：
    * 如果預測是「相同結果」且 $i$ 是 YES $\rightarrow$ 買入 $j$ 的 YES 。
    * 如果預測是「相同結果」且 $i$ 是 NO $\rightarrow$ 買入 $j$ 的 NO 。
    * 如果預測是「不同結果」，則反向操作
* 安全過濾機制
    * 極端價格過濾： 如果進場時價格太接近 0 或 1（作者設定閾值為 0.1，即價格 < 0.1 或 > 0.9），則不交易 。
    * 最終價格品質過濾： 要求市場 $j$ 的最終價格必須是決定性的（接近 0 或 1），以避免處理模糊不清的結算 。
* 損益計算 (PnL)：
    * 假設單位賭注（Unit-stake）。
    * 若賭對：獲利 $= 1 - \text{進場價格}$ 。
    * 若賭錯：虧損 $= -\text{進場價格}$ 。





### 結果如何?
#### AI 判斷邏輯的實例解析
範例 1：邏輯互斥 (Logical Mutual Exclusivity)
* 市場 A (Leader)： 川普會在五月前提高對加拿大的關稅嗎？
* 市場 B (Follower)： 川普會在五月前取消對加拿大的關稅嗎？
* AI 判斷結果：
    * 關係： 不同結果 (False)。即如果 A 是 Yes，B 一定是 No；反之亦然。
    * 信心分數： 0.95 (極高)。
* 理由 (Rationale)： 這兩個問題描述的是針對同一對象（加拿大）、同一時間範圍（五月前）的相反政策行動。川普不可能同時「提高」又「取消」關稅。
* 這是最理想的狀況，屬於「教科書級別」的互斥案例。AI 能夠識別出語義上的直接衝突，因此給出極高的信心分數。

範例 2：因果連鎖 (Causal Linkage)
* 市場 A： 川普會在五月前對歐盟酒類徵收關稅嗎？
* 市場 B： 歐盟會在五月前對美國徵收關稅嗎？
* AI 判斷結果：
    * 關係： 相同結果 (True)。即兩者很可能同時發生。
    * 信心分數： 0.85 (高，但低於範例 1)。
* 理由 (Rationale)： 這是基於「貿易戰升級」的情境。如果川普先動手（徵稅），歐盟極高機率會報復（tit-for-tat dynamics）。反之，若川普不動，歐盟也不太可能主動開戰。
* 這不是邏輯上的絕對，而是高度的統計相關性或因果假設。因此，AI 給出的信心分數（0.85）正確地反映了這層不確定性（比純邏輯互斥低）。

#### 視覺化分析
#### 價格動態圖 (Price Dynamics)
![image](https://hackmd.io/_uploads/S1ybSUvrZe.png)
* 內容： 展示了一對「相同結果」市場的價格走勢。
* 關鍵點 (Vertical Dashed Line)： 圖中有一條垂直虛線，標記了較早解決的市場（Leader） 的解決時間點。
* 策略執行細節：
    * Leader 市場解決（結果為 YES）。
    * 策略在虛線後的第一個價格跳動點進場買入 Follower 市場。
    * 因為 AI 預測兩者是「相同結果」，所以策略買入 Follower 的 YES。
* 獲利計算： 進場時價格約為 0.25（圖中顯示價格在低點），最終結果為 YES（價格歸 1）。獲利 $\approx 1 - 0.25 = 0.75$。這證明了 Leader 的資訊尚未完全反映在 Follower 的價格上，存在套利空間。

#### 關係圖譜 (Relationship Graph)
![image](https://hackmd.io/_uploads/Syy1IUvSZg.png)
* 結構： 節點 (Node) 是市場問題；邊 (Edge) 是預測的關係。
* 顏色編碼：
    * 黑色線： 預測為「相同結果」。
    * 藍色線： 預測為「不同結果」。
    * 實線 (Solid)： 預測正確。
    * 虛線 (Dashed)： 預測錯誤。
* 洞察： 圖表顯示 AI 構建的關係網在邏輯上是一致的。例如它滿足「三角符號約束 (Triadic sign constraints)」：如果 A 與 B 相同，B 與 C 相同，則 A 與 C 不應該是不同。這表明 AI 具備結構化的推理能力。

#### 準確率統計 (Prediction Accuracy)
作者在 2025 年 4 月至 7 月間進行了重複 30 次的實驗，評估 AI 的預測準度。
* Cluster Accuracy (群組準確率)： 先算每個群組內的準確率，再取平均。這能避免大群組主導結果。
* Overall Accuracy (整體準確率)： 把所有配對混在一起算準確率。
![image](https://hackmd.io/_uploads/B1aGUIPBbx.png)
* 表現好的月份 (4-6月)：
    * 4月：群組平均準確率 63.9%。
    * 5月：群組平均準確率 59.3%。
    * 6月 (最佳)： 群組平均準確率 62.1%，整體準確率高達 72.6%。
* 表現差的月份 (7月)：
    * 7月：準確率大幅下降，群組平均僅 41.2%（低於隨機猜測的 50%）。
    
 原因推測： 7 月份的問題可能語義較模糊，或者缺乏明確的邏輯連結（如範例 1 那樣的送分題），導致 AI 判斷失準。這顯示了模型對「問題分佈 (Question Distribution)」的敏感性。

### 交易回測績效 (Trading Performance)
最關鍵的問題：這些預測能賺錢嗎？

#### 回測設定
使用「領導者-追隨者」策略，僅在 Leader 解決後才進場交易 Follower。
#### 績效數據 (Table 4)
![image](https://hackmd.io/_uploads/ryOdILvH-g.png)
* 獲利月份 (4-6月)：
    * 4月平均回報 (ROI)：+24.8%。
    * 5月平均回報：+8.7%。
    * 6月平均回報：+47.5%（中位數 45.7%）。與該月最高的預測準確率相呼應。
* 虧損月份 (7月)：
    * 7月平均回報：-12.3%。這與該月準確率崩盤完全一致。
    * 風險提示 (Volatility)：
    * 標準差 (Std) 非常高 (25.7% ~ 41.6%)。
這意味著績效很不穩定。因為交易次數少（High-confidence pairs 不多），只要錯判一兩個高信心的單子，就會嚴重影響總體獲利。
#### 時間延遲 (Time Delay)
* Leader 和 Follower 解決的時間差，平均約為 1 到 2 週。
* 意義： 這段時間差就是策略的「獲利窗口」。資訊已經在 Leader 市場公開（已解決），但 Follower 市場卻反應遲鈍，AI 抓住了這個資訊傳遞的延遲。

### 建議
* 不僅是描述性，更是經濟性訊號： 高準確率月份對應高回報，證明 AI 發現的語義關係具有實際的經濟價值（Economic Meaning），而非隨機巧合。
* 對月份的敏感度 (Seasonality/Regime Change)：
    * 有些月份問題模稜兩可，AI 就會賠錢。
* 實部署建議 (Practical Deployment)：
    * 校準信心門檻： 必須動態調整 Confidence Threshold，在模糊的月份提高門檻。
    * 引入不確定性過濾： 增加過濾機制，避開語義含糊的市場。
    * 外部資訊： 在問題描述不足時，AI 應該主動去搜尋外部新聞（News/Search）來輔助判斷，這在表現差的月份（如 7 月）特別重要。

----
### 值得思考的地方
這篇論文
* 驗證了在預測市場中，語義結構（Semantic Structure）本身就是一種可交易的 Alpha（超額報酬來源）
* 再來是用 NLP（自然語言處理）取代統計學來找資產關聯
* 將 MCP 作為標準化接口，讓 AI 能自動化地完成「讀取 -> 分群 -> 找關係 -> 交易」的一條龍流程 

#### 目前的問題： 
* 目前的策略是「等待 Leader 完全解決 (Resolved) 才進場」 。
* 我覺得這裡太慢了，應該打不贏高頻交易，雖然我覺得下面這兩個解法也打不贏高頻
    * 改成當 Leader 價格突破 0.95 或 0.98 且維持一定時間，就視為「準解決」，提前對 Follower 建倉。
    * 如果 AI 判斷 A 與 B 是「相同結果」，理論上它們的價差 (Spread) 應該接近 0。如果發現 $|Price_A - Price_B| > 0.2$，就直接做多低價者、做空高價者，賺取價差收斂的利潤


* 目前的 AI 主要依賴「靜態的合約文字」進行推理 。雖然論文提到可以選擇性加入新聞摘要 ，但在核心測試中似乎主要依賴合約本身的語義。當合約文字模糊或事件背景複雜時（如 7 月的數據），AI 容易誤判
    * 整合即時新聞

* 目前分類過於僵化:使用的是預設的靜態分類（如政治、加密貨幣） 。這無法捕捉突發的新興主題（例如「奧運」或特定突發醜聞
    * 用GNN，或是用COT檢查邏輯
    * 動態主題生成(根據當下的熱門主題生成主題名稱)

#### 風險控制
這裡是我比較關注的，前面我覺得可以有可無
重點是標準差太大了，要怎麼控制住風險? 用 Platt Scaling 和凱利
* LLM的信心不代表勝率，所以也許可以去訓練一個邏輯回歸模型去將LLM分數映射回真實機率
    * Platt Scaling
        * 解決 LLM 「過度自信」的問題

有了機率後，凱利公式就派上用場了
* 投資組合管理 (Kelly Criterion)： 目前的策略是「單位賭注 (Unit-stake)」 ，即每把下注一樣多。
    * 根據校準後的勝率與賠率，使用 凱利公式 (Kelly Criterion) 動態調整倉位大小。對於高信心且賠率好的機會下重注，對於模糊的機會下小注，這能有效平滑資金曲線。

凱利公式 (Kelly Criterion)： $f^* = \frac{bp - q}{b}$
* 其中 $p$ 是真實勝率。
* 如果你直接拿 LLM 的原始分數 ($0.95$) 當作 $p$ 代入凱利公式，你會算出一個巨大的下注比例（All-in）。
*  但因為真實勝率其實只有 $0.7$，你這樣重倉下注，幾次運氣不好就會破產 (Ruined)。
使用邏輯回歸，是為了把 AI 誇大的「信心 ($0.95$)」拉回現實的「勝率 ($0.7$)」。這樣你才能根據真實的風險，算出正確的下注金額，這是在長期量化交易中存活的關鍵

我認為由 LLM 進行交易的研究可能都會遇上信心的問題，之後可以嘗試看看如何控制住風險，但不曉得控制住風險後會不會就變成超級保守。
還有就是這整個MCP跟資料要真的建起來，很麻煩阿.....

認真的從頭學一次凱利公式好了.....上次老師丟凱利公式的文章到現在都還沒看完(汗顏)

