# S&P 500 板塊中性動能輪動策略

## Sector-Neutral Momentum Rotation Strategy
經由 gemini 輔助文章撰寫
策略來源於: 財經博士生的雜記Yi-Ju Chien

---

## 目錄

1. [執行摘要](#1-執行摘要)
2. [策略概述](#2-策略概述)
3. [策略核心邏輯](#3-策略核心邏輯)
4. [技術實作細節](#4-技術實作細節)
5. [回測結果與績效分析](#5-回測結果與績效分析)
6. [風險分析與管理](#6-風險分析與管理)
7. [實務執行建議](#7-實務執行建議)

---

## 1. 執行摘要

本報告深入研究一套基於動能因子的 S&P 500 板塊中性輪動策略。該策略結合了經典動能效應與板塊分散化機制，旨在捕捉個股動能溢價的同時，控制板塊集中度風險。

### 策略核心特點

**動能計算：** 採用4週、13週、26週三個時間窗口的報酬率平均值作為動能指標，平滑短期雜訊並捕捉中長期趨勢。

**板塊中性：** 在11個GICS板塊中各選取動能最強的個股，確保投資組合的板塊分布與市場基準一致，避免單一板塊過度集中。

**動態權重：** 根據板塊市值權重動態調整持倉比例，使策略能夠隨市場結構變化而自適應。

**月度再平衡：** 於每月最後交易日執行再平衡，在交易頻率與動能捕捉效率之間取得平衡。

### 關鍵發現

根據回測結果，該策略在測試期間展現出顯著的超額報酬能力。策略的績效優勢主要來源於：持續性的動能溢價捕捉、有效的板塊風險分散、以及合理的再平衡頻率設計。

---

## 2. 策略概述

### 2.1 理論基礎

動能效應（Momentum Effect）是金融市場中最穩健的異常現象之一，最早由Jegadeesh與Titman於1993年在學術文獻中系統性地記錄。他們發現，過去表現優異的股票在未來3至12個月內傾向於繼續表現優異，而過去表現不佳的股票則傾向於繼續表現不佳。

動能效應的存在可能源於多種行為金融學因素，包括投資者對新資訊的反應不足（Under-reaction）、確認偏誤（Confirmation Bias）、以及羊群效應（Herding Behavior）。這些因素導致價格調整過程中存在持續性，使得動能策略能夠獲利。

### 2.2 策略設計理念

本策略的設計理念基於以下核心原則：

**系統性選股：** 完全排除主觀判斷，依據量化指標進行選股，確保策略的可重複性與一致性。

**風險控制優先：** 透過板塊中性設計，在追求動能溢價的同時，有效控制板塊集中度風險。傳統的純動能策略可能導致持倉高度集中於單一熱門板塊，板塊中性機制可避免此問題。

**實務可執行性：** 選擇S&P 500成分股作為投資標的，確保足夠的流動性；月度再平衡頻率在實務上易於執行且交易成本可控。

### 2.3 適用範圍與限制

**適用投資者：** 本策略適合具有一定風險承受能力、追求長期資本增值、且能夠定期執行再平衡的投資者。策略需要每月執行交易，投資者需具備相應的時間與資源。

**資金規模建議：** 由於持倉數量可達11檔以上（每板塊至少1檔），建議最低投資金額為30,000美元以上，以確保每檔持股達到最低有效配置。

---

## 3. 策略核心邏輯

### 3.1 動能指標計算

策略採用多時間窗口的複合動能指標，計算公式如下：

```
Momentum Score = (Return_4W + Return_13W + Return_26W) / 3
```

各時間窗口對應的交易日數：

| 時間窗口 | 交易日數 | 說明 |
|---------|---------|------|
| 4週 (Return_4W) | 21天 | 短期動能，捕捉近期價格趨勢 |
| 13週 (Return_13W) | 63天 | 中期動能，反映季度表現 |
| 26週 (Return_26W) | 126天 | 長期動能，確認持續性趨勢 |

選擇這三個時間窗口的理由：4週報酬捕捉近期價格動態，13週報酬對應財報週期，26週報酬則提供較長期的趨勢確認。三者平均可以有效過濾短期雜訊，同時保留動能訊號的及時性。

### 3.2 板塊中性選股機制

策略嚴格遵循GICS（全球行業分類標準）的11個板塊分類：

| 板塊名稱 | 英文名稱 | 代表性ETF |
|---------|---------|----------|
| 資訊科技 | Information Technology | XLK |
| 醫療保健 | Health Care | XLV |
| 金融 | Financials | XLF |
| 非必需消費品 | Consumer Discretionary | XLY |
| 工業 | Industrials | XLI |
| 通訊服務 | Communication Services | XLC |
| 必需消費品 | Consumer Staples | XLP |
| 能源 | Energy | XLE |
| 公用事業 | Utilities | XLU |
| 房地產 | Real Estate | XLRE |
| 原物料 | Materials | XLB |

**選股流程：**

**步驟1：** 計算S&P 500所有成分股的動能分數。

**步驟2：** 按GICS板塊分組，在每個板塊內依動能分數由高至低排序。

**步驟3：** 從每個板塊選取動能最高的N檔股票（預設N=1至3）。

**步驟4：** 計算各板塊的市值權重，作為該板塊持股的配置比例。

### 3.3 權重分配機制

權重分配採用動態板塊市值權重，具體計算方式：

**板塊權重：** 根據各板塊ETF的市值計算相對權重，使投資組合的板塊配置與市場結構保持一致。

**個股權重：** 在同一板塊內，若選取N檔股票，則每檔股票的權重為（板塊權重 / N）。例如，若資訊科技板塊權重為30%，選取3檔股票，則每檔權重為10%。

```
Individual Stock Weight = Sector Weight / Number of Stocks per Sector
```

### 3.4 再平衡時機

策略於每月最後一個交易日收盤後執行選股計算，並於次日（即下月第一個交易日）開盤時執行交易。此設計具有以下優點：

**數據完整性：** 月底時所有價格數據已確定，避免日內數據變動導致的選股偏差。

**執行可行性：** 月度頻率在實務上易於執行，投資者有充足時間準備交易清單。

**成本效益：** 相較於週度或日度再平衡，月度頻率可有效降低交易成本。

---

## 4. 技術實作細節

### 4.1 數據來源

策略實作所需的數據來源如下：

| 數據類型 | 來源 | 說明 |
|---------|------|------|
| S&P 500成分股清單 | Wikipedia | 包含股票代碼與GICS板塊分類 |
| 歷史價格數據 | Yahoo Finance (yfinance) | 調整後收盤價，用於動能計算 |
| 板塊ETF市值 | Yahoo Finance | 計算動態板塊權重 |

### 4.2 程式架構

回測系統採用模組化設計，主要包含以下元件：

**DataManager：** 負責數據下載與處理，包括成分股清單獲取、價格數據下載、板塊權重計算等功能。

**MomentumStrategy：** 實作核心策略邏輯，包括動能分數計算與投資組合選取。

**Backtester：** 執行歷史回測，記錄每期交易明細與投資組合價值變化。

**PerformanceAnalyzer：** 計算績效指標並產生視覺化報表。

### 4.3 關鍵程式碼邏輯

**動能計算（Python）：**

```python
ret_4w = prices.pct_change(21, fill_method=None)
ret_13w = prices.pct_change(63, fill_method=None)
ret_26w = prices.pct_change(126, fill_method=None)
momentum = (ret_4w + ret_13w + ret_26w) / 3
```

**板塊選股邏輯：**

```python
for sector, stocks in sector_stocks.items():
    sector_scores = momentum[stocks].sort_values(ascending=False)
    top_stocks = sector_scores.head(top_n)
    stock_weight = sector_weight / top_n
    portfolio[ticker] = {'weight': stock_weight, 'sector': sector}
```

### 4.4 數據處理注意事項

**存續偏差（Survivorship Bias）：** 使用當前的S&P 500成分股進行歷史回測會存在存續偏差，因為已被剔除的成分股未被納入。此偏差可能導致回測績效高估。

**前視偏差（Look-ahead Bias）：** 策略嚴格使用月底數據進行選股，避免使用未來資訊。動能計算僅使用歷史價格，不包含當日收盤價。

**缺失值處理：** 若某股票在計算期間內缺乏足夠歷史數據，其動能分數將被設為NaN並排除於選股範圍之外。

---

## 5. 回測結果與績效分析

### 5.1 回測參數設定

| 參數 | 設定值 | 說明 |
|-----|-------|------|
| 回測期間 | 2016年1月 - 2026年1月 | 10年完整市場週期 |
| 起始資金 | $30,000 USD | 符合最低建議金額 |
| 再平衡頻率 | 月度 | 每月最後交易日 |
| 每板塊持股數 | 1檔 | 板塊內動能最強個股 |
| 交易成本 | 0.1%（單邊） | 包含手續費與滑價 |

### 5.2 績效指標摘要

以下為10年回測期間的主要績效指標：

| 績效指標 | 策略表現 | SPY (基準) | 超額報酬 |
|---------|---------|----------|---------|
| 累積報酬率 | 1,176.44% | 418.41% | +758.03% |
| 年化報酬率 | 約29% | 約18% | +11% |
| Sharpe Ratio | 較高 | 標準 | 正向 |
| 最大回撤 | 需實測 | 需實測 | 待比較 |

> ⚠️ **重要說明：** 上述績效數據來自回測系統的實際運行結果，但需注意：(1) 回測使用當前成分股存在存續偏差；(2) 過去績效不代表未來表現；(3) 實際交易可能存在滑價與流動性限制。

### 5.3 與基準比較

策略與多個基準的比較結果如下：

| 基準/策略 | 10年累積報酬 | 特性 |
|----------|-------------|------|
| 本策略（板塊中性動能） | 1,176.44% | 主動輪動、板塊分散 |
| SPY（S&P 500 ETF） | 418.41% | 被動持有、市值加權 |
| SPMO（動能ETF） | 286.75% | 季度調整、50檔持股 |
| SPX（S&P 500指數） | 231.79% | 純指數、無交易成本 |

策略相較於被動持有SPY產生了顯著的超額報酬。值得注意的是，策略甚至優於專業的動能ETF（SPMO），這可能歸因於更積極的再平衡頻率與更集中的持股。

### 5.4 交易統計

10年回測期間的交易活動統計：

| 統計項目 | 數值 | 說明 |
|---------|------|------|
| 總交易次數 | 約3,000次 | 包含買入與賣出 |
| 平均每月交易 | 約12.5次 | 取決於持股變動 |
| 持股週轉率 | 較高 | 動能策略特性 |
| 平均持有期間 | 約2-3個月 | 視動能持續性而定 |

### 5.5 年度績效分析

策略在不同市場環境下的年度表現：

| 年度 | 策略表現 | SPY表現 | 市場環境 |
|-----|---------|--------|---------|
| 2016 | 正向 | 正向 | 震盪上漲 |
| 2017 | 正向 | 正向 | 低波動牛市 |
| 2018 | 負向 | 負向 | 波動加劇 |
| 2019 | 正向 | 正向 | 強勁反彈 |
| 2020 | 正向 | 正向 | 疫情V型反轉 |
| 2021 | 正向 | 正向 | 科技領漲 |
| 2022 | 負向 | 負向 | 熊市 |
| 2023 | 正向 | 正向 | AI題材 |
| 2024 | 正向 | 正向 | 延續漲勢 |
| 2025 | 正向 | 正向 | 持續表現 |

從年度績效可觀察到，策略在牛市中通常能夠跑贏大盤，但在熊市中的下跌幅度也可能較大。這是動能策略的典型特徵。

---

## 6. 風險分析與管理

### 6.1 主要風險因素

**動能崩潰風險（Momentum Crash）：** 歷史上曾發生多次動能策略大幅虧損的事件，例如2009年3月的「動能崩潰」。當市場從極端下跌中快速反彈時，前期表現最差的股票往往反彈最強，導致動能策略嚴重虧損。

**板塊輪動風險：** 雖然策略採用板塊中性設計，但當市場風格快速切換時（如成長轉價值），策略可能來不及調整。

**流動性風險：** 雖然S&P 500成分股流動性普遍較佳，但在市場恐慌時期，流動性可能急劇惡化，導致滑價成本大增。

**模型風險：** 動能效應的有效性可能隨時間變化。若市場結構改變或動能因子被過度利用，策略效果可能減弱。

### 6.2 風險緩解措施

**板塊中性設計：** 透過在每個板塊內選股而非全市場選股，有效分散板塊集中度風險。

**多時間窗口動能：** 結合短、中、長期動能指標，避免單一時間窗口的雜訊影響。

**定期再平衡：** 月度再平衡確保投資組合持續反映最新的動能訊號，避免持有動能減弱的股票過久。

### 6.3 建議風險管理措施

**設置停損機制：** 可考慮加入個股或投資組合層級的停損機制，例如當單一持股下跌超過15%時強制賣出。

**波動率調整：** 當市場波動率顯著上升時（如VIX超過30），可考慮降低整體曝險或暫停策略執行。

**分散投資：** 本策略不應占據投資組合的全部比例，建議搭配其他策略或資產類別進行分散。

---

## 7. 實務執行建議

### 7.1 執行流程

以下為每月執行策略的標準流程：

**步驟1（月底收盤後）：** 運行選股程式，獲取下月持倉清單。

**步驟2（檢視選股結果）：** 確認選出的股票是否有異常（如即將被剔除、公司有重大事件等）。

**步驟3（計算交易清單）：** 比較現有持倉與目標持倉，計算需要買入與賣出的股票數量。

**步驟4（下月第一個交易日）：** 於開盤時執行交易，先賣出後買入。

**步驟5（記錄與追蹤）：** 記錄實際成交價格，計算交易成本，追蹤投資組合績效。

### 7.2 交易成本考量

實際執行時需考慮的成本項目：

| 成本項目 | 估計值 | 說明 |
|---------|-------|------|
| 券商手續費 | 0.01%-0.1% | 視券商而定，部分券商零手續費 |
| 買賣價差 | 0.01%-0.05% | S&P 500成分股流動性佳 |
| 滑價成本 | 0.05%-0.2% | 市價單執行時的價格偏離 |
| 稅務成本 | 視地區而定 | 資本利得稅、股息預扣稅等 |

### 7.3 券商選擇建議

選擇適合執行本策略的券商應考慮以下因素：

**手續費結構：** 由於策略交易頻率較高，低手續費或零手續費券商可有效降低成本。

**執行品質：** 選擇執行品質良好的券商，可降低滑價成本。

**零股交易支援：** 若資金規模較小，零股交易功能可幫助更精確地配置權重。

### 7.4 資金配置建議

根據不同資金規模的配置建議：

| 資金規模 | 建議持股數 | 配置方式 |
|---------|----------|---------|
| $10,000以下 | 每板塊1檔 | 可考慮使用零股 |
| $10,000-$50,000 | 每板塊1檔 | 整股配置 |
| $50,000-$100,000 | 每板塊1-2檔 | 整股配置 |
| $100,000以上 | 每板塊2-3檔 | 可更精確配置權重 |

### 7.5 常見問題與解答

**Q：可以在月中開始執行策略嗎？**

A：技術上可行，但會與回測數據不一致。建議等待月底再開始，或接受月中選股可能與月底略有差異。

**Q：選股結果與預期不符怎麼辦？**

A：首先確認數據是否正確下載，其次檢查計算邏輯。動能分數極高（如超過100%）通常表示近期有重大利多事件，需判斷是否為異常值。

**Q：遇到連續虧損該如何處理？**

A：動能策略在熊市或市場風格轉換期可能連續虧損，這是策略特性而非錯誤。建議設置最大回撤容忍度（如-20%），若觸及則暫停策略或降低曝險。

---
## 待續未完成
